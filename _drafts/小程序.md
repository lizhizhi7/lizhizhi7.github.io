微信小程序：分页和加载更多
2018年10月07日 14:29:22 qq_37461695 阅读数：513
直接上代码吧。不足之处，多多指教，一起进步

1.wxml页面的最后敲上，css自己定义

<view class="loadmore" mtype="{{mtype}}" hidden="{{hidden}}"><text>已经没有更多了~</text></view>
2.js的初始数据中设置：

data: {
    page: 0,    //当前页
    totalPage: 0,   //总页数
    mtype: 1,    //加载更多动画显示类型
    hidden: true    //加载动画显示与隐藏
},
3.js的内置触底函数中如下操作

//页面滑动到底部
onReachBottom: function (e) {
    console.log("lower");
    var that = this;
    var page = that.data.page + 1;  //当前页+1 = 下一页
    that.getPhotoInfo(page);
},
4.js后台交互函数

getPhotoInfo:function(e){
    var that = this;
    var atPage = e; //当前页
    var params = {
        page: atPage //页数
    };

    if(atPage == 1){
        api.getPhotoInfo(params).then(res => {
            console.log(res)
        if (res['code'] == '200') {
            wx.stopPullDownRefresh(); //停止下拉刷新
            //更新数据
            that.setData( {
                photoInfo: res.data.list,
                page: atPage,
                totalPage: res.data.totalPage,
                hidden: true,
                mtype: 1
            });
        }
        })
    }else if(atPage <= that.data.totalPage){
        api.getPhotoInfo(params).then(res => {
            console.log(res)
        if (res['code'] == '200') {
            wx.stopPullDownRefresh(); //停止下拉刷新
            //更新数据
            that.setData( {
                photoInfo: that.data.photoInfo.concat(res.data.list),  //此处concat类似push，但又不完全是，可以测试下
                page: atPage,
                totalPage: res.data.totalPage,
                hidden: true,
                mtype: 1
            });
        }
        })
    }else {
        //更新数据，已经没有了 返回
        that.setData( {
            hidden: false,
            mtype: 1
        });
    }
},
 

 nginx常用的基础命令总结
#默认方式启动：
./sbin/nginx 

#指定配置文件启动 
./sbing/nginx -c /tmp/nginx.conf 

#指定nginx程序目录启动
./sbin/nginx -p /usr/local/nginx/

#快速停止
./sbin/nginx -s stop

#优雅停止 (会等当前的请求先处理完再杀死)
./sbin/nginx -s quit

# 热装载配置文件 
./sbin/nginx -s reload
# 重新打开日志文件
./sbin/nginx -s reopen

# 检测配置是否正确
./sbin/nginx -t


启动nginx之后，可以通过日志来查看进程的相关信息

[root@idea-centos nginx]# ./sbin/nginx
[root@idea-centos nginx]# ps -ef|grep nginx
root      11059      1  0 16:34 ?        00:00:00 nginx: master process ./sbin/nginx
nobody    11060  11059  0 16:34 ?        00:00:00 nginx: worker process
root      11062   8193  0 16:34 pts/1    00:00:00 grep --color=auto nginx
master process 主要是负责日志的更新，热装载 主进程
worker process 工作进程 处理客户端的连接，处理请求

nginx的日志

在nginx的log文件夹底下，我们在重新访问服务器之后，相应的access日志就会增加新的属性内容。

这里面的日志寻找，实际上是根据对象句柄来进行查找指定的文件。