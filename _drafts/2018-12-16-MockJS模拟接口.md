---
layout:     post
title:      MockJS模拟接口
subtitle:   JavaScript系列笔记（一）
date:       2018-12-20
author:     Lee
header-img: img/background-js.jpg
catalog: true
tags:
    - JavaScript
---

# Mock.js脱离后端独立开发，实现增删改查功能

在我们实际的生产环境中，前后端的开发往往是不同步的，而前端的开发又要依赖于后端的接口，这样对于前端开发者来说显得十分被动。那么如何才能在后端开发的同时，我们前端也能进行接口的测试呢？今天给大家来介绍一款非常强大的插件Mock.js，它可以非常方便的模拟后端的数据，也可以轻松的实现增删改查这些操作。

### 简单的用法

```javascript
Mock.mock('http://123.com',{
    'name|3':'fei',//这个定义数据的模板形式下面会介绍
    'age|20-30':25,
})
$.ajax({
    url:'http://123.com',
    dataType:'json',
    success:function(e){
       console.log(e)
    }
})
```
在这个例子中我们截获地址为`http://123.com`返回的数据是一个拥有name和age的对象，那么ajax返回的数据就是Mock定义的数据，返回的数据格式如下：
```javascript
{
     name:'feifeifei',
     age:26,
}
```
### 数据定义格式

数据模板中的每个属性由 3 部分构成：属性名、生成规则、属性值：**'name|rule': value**。下面分别就各个类型进行说明
 * `'name|min-max': string` 通过重复 string 生成一个字符串，min<=重复次数<=max
 * `'name|count': string`   通过重复 string 生成一个字符串，重复次数等于 count

 * `'name|min-max': number`   生成一个min<=整数<=max，属性值 number 只是用来确定类型
   例：`'age|20-30':25`生成一个大于等于 20、小于等于 30 的整数，属性值 25 只是用来确定类型
 * `'name|+1': number`   属性值自动加 1，初始值为 number，以后每次请求在前面的基础上+1
 * `'name|min-max.dmin-dmax': number`   生成一个浮点数，min<=整数部分<=max，小数部分保留 dmin 到 dmax 位。
   例：`'weight|100-120.2-5':110.24,`生成一个浮点数,整数部分大于等于 100、小于等于 120，小数部分保留 2 到 5 位
 * `'name|1': boolean`   随机生成一个布尔值，值为 true 的概率是 1/2，值为 false 的概率同样是 1/2

 * 属性值是对象：
 `'name|count': object` 从属性值 object 中随机选取 count 个属性
`'name|min-max': object` 从属性值 object 中随机选取 min 到 max 个属性
例：
```javascript
var obj={'host':'www.baidu','port':'12345','node':'selector'}
'life1|2':obj //从属性值 obj 中随机选取 2 个属性
'life1|1-2':obj //从属性值 obj 中随机选取 1 到 2 个属性。
```
 * 属性值是数组：
 `'name|1': array` 从属性值 array 中随机选取 1 个元素，作为最终值
`'name|+1': array` 从属性值 array 中顺序选取 1 个元素，作为最终值
`'name|count': array` 通过重复属性值 array 生成一个新数组，重复次数为 count
`'name|min-max': array` 通过重复属性值 array 生成一个新数组，重复次数大于等于 min，小于等于 max
例：
```javascript
var arr=['momo','yanzi','ziwei']
'friend1|1':arr //从数组 arr 中随机选取 1 个元素，作为最终值
'friend2|+1':arr //从属性值 arr 中顺序选取 1 个元素，作为最终值，第一次就是'momo',第二次请求就是'yanzi'
'friend3|2':arr //重复arr这个数字2次作为这个属性值，得到数据应该是['momo','yanzi','ziwei','momo','yanzi','ziwei']
'friend3|2-3':arr //通过重复属性值 arr 生成一个新数组，重复次数大于等于 2，小于等于 3
```
### 实际应用举例
```javascript
var arr=['momo','yanzi','ziwei']
var obj={
    'host':'www.baidu',
    'port':'12345',
    'node':'selector'
    }
Mock.mock('http://www.bai.com',{
    'firstName|3':'fei',//重复fei这个字符串 3 次，打印出来就是'feifeifei'。
    'lastName|2-5':'jiang',//重复jiang这个字符串 2-5 次。
    'big|+1':0, //属性值自动加 1，初始值为 0
    'age|20-30':25,//生成一个大于等于 20、小于等于 30 的整数，属性值 25 只是用来确定类型
    'weight|100-120.2-5':110.24,//生成一个浮点数,整数部分大于等于 100、小于等于 120，小数部分保留 2 到 5 位。
    'likeMovie|1':Boolean,//随机生成一个布尔值，值为 true 的概率是 1/2，值为 false 的概率同样是 1/2。
    'friend1|1':arr,//从数组 arr 中随机选取 1 个元素，作为最终值。
    'friend2|+1':arr,//从属性值 arr 中顺序选取 1 个元素，作为最终值
    'friend3|2-3':arr,//通过重复属性值 arr 生成一个新数组，重复次数大于等于 2，小于等于 3。
    'life1|2':obj,//从属性值 obj 中随机选取 2 个属性
    'life1|1-2':obj,//从属性值 obj 中随机选取 1 到 2 个属性。
    'regexp1':/^[a-z][A-Z][0-9]$/,//生成的符合正则表达式的字符串
    })
$.ajax({
    url:'http://www.bai.com',
    dataType:'json',
    success:function(e){
    console.log(e)
    }
})
```

至于更多的详细文档可以去[官方文档](http://mockjs.com/)上查看，Mock.js简单易学，可以便于前端的快速开发，也可以自己定义好需要的格式，让后端配合你，按照你的格式编写他的后端代码。